# Vaccine

Analyst! It appears the network for managing Vaccine resources has been breached once more, but we managed to catch the threat actors on initial access. They accidentally dropped what seems to be one of their practice payloads (from the Sektor7 Red Team Operator course too?). We're a little bogged down in paperwork right now because of all of these breaches happening at once, but we think there might be some sensitive information about the actors and/or their TTPs. Could you unravel their antics?

## Solution
The sample given is a classic process injector written in C++. There are 2 ways to do this, either using static or dynamic analysis:
- **Static Analysis**: Decompile with ghidra, and observe that a number of things are getting XORed with the string "SuperSekretKey". Use PEStudio or some other PE inspection tool to find shellcode inside the .rsrc section, and copy the shellcode out. XOR the shellcode with the key (iterate over the bytes and the characters in the key), and find the flag.
- **Dynamic Analysis**: Run the malware and analyze running processes with Process Hacker. Identify `explorer.exe` as the program being injected into, and explore the memory modules to find an RWX section, which should have the flag in it, since the payload gets decrypted at runtime.
